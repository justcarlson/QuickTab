---
phase: 06-cicd-automation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - release-please-config.json
  - .release-please-manifest.json
  - .github/workflows/release-please.yml
autonomous: true

must_haves:
  truths:
    - "Push to master creates/updates a release PR automatically"
    - "Release PR shows version bump in package.json"
    - "Release PR shows changelog entries from conventional commits"
  artifacts:
    - path: "release-please-config.json"
      provides: "Changelog sections mapping and release-type config"
      contains: "changelog-sections"
    - path: ".release-please-manifest.json"
      provides: "Current version tracking for release-please"
      contains: "0.12.3"
    - path: ".github/workflows/release-please.yml"
      provides: "GitHub Actions workflow for release PR management"
      contains: "googleapis/release-please-action@v4"
  key_links:
    - from: ".github/workflows/release-please.yml"
      to: "release-please-config.json"
      via: "config-file input"
      pattern: "config-file: release-please-config.json"
    - from: ".github/workflows/release-please.yml"
      to: ".release-please-manifest.json"
      via: "manifest-file input"
      pattern: "manifest-file: .release-please-manifest.json"
---

<objective>
Configure release-please for automated version management and changelog generation.

Purpose: Enable automated release PRs that accumulate conventional commits, bump versions in package.json, and generate Keep a Changelog formatted entries.

Output: Three files - release-please config, manifest, and GitHub Actions workflow that creates release PRs on push to master.

**Pre-satisfied requirements:** CICD-01 (CI on PR) and CICD-02 (CI on push to master) are already satisfied by `.github/workflows/ci.yml` created in Phase 4. That workflow triggers on both `pull_request: branches: [master, main]` and `push: branches: [master, main]`. This plan focuses on CICD-03, CICD-04, and CICD-05 (release automation).
</objective>

<execution_context>
@/home/jc/.claude/get-shit-done/workflows/execute-plan.md
@/home/jc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-cicd-automation/06-RESEARCH.md
@.github/workflows/ci.yml
@CHANGELOG.md
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create release-please configuration files</name>
  <files>release-please-config.json, .release-please-manifest.json</files>
  <action>
Create two JSON configuration files for release-please v4:

**release-please-config.json:**
- Set release-type to "node" (updates package.json version)
- Set include-v-in-tag to true (creates v1.0.0 style tags)
- Set include-component-in-tag to false (no monorepo component prefix)
- Set pull-request-title-pattern to "chore: release ${version}"
- Configure changelog-sections to match Keep a Changelog format:
  - feat -> "Added"
  - fix -> "Fixed"
  - perf -> "Changed"
  - refactor -> "Changed"
  - deps -> "Dependencies"
  - docs, chore, test, ci, build -> hidden: true
- Set packages with "." root and changelog-path: "CHANGELOG.md"

**.release-please-manifest.json:**
- Single object with ".": "0.12.3" (current package.json version)

Important: Use proper JSON schema reference for config validation.
  </action>
  <verify>
Both files exist and are valid JSON:
```bash
cat release-please-config.json | jq .
cat .release-please-manifest.json | jq .
```
  </verify>
  <done>Config file has changelog-sections array, manifest file has current version "0.12.3"</done>
</task>

<task type="auto">
  <name>Task 2: Create release-please workflow</name>
  <files>.github/workflows/release-please.yml</files>
  <action>
Create GitHub Actions workflow for release-please:

**Workflow configuration:**
- name: "Release Please"
- Trigger: push to master branch (this repo uses master, not main)
- permissions: contents: write, pull-requests: write
- Single job "release-please" on ubuntu-latest

**Steps:**
1. Use googleapis/release-please-action@v4
2. Set id: release (for output capture)
3. Configure with:
   - config-file: release-please-config.json
   - manifest-file: .release-please-manifest.json

**Outputs section:**
- release_created: ${{ steps.release.outputs.release_created }}
- tag_name: ${{ steps.release.outputs.tag_name }}

Note: Do NOT use releases_created (plural) - it has a known bug in v4. Use release_created (singular).
  </action>
  <verify>
Workflow file syntax is valid:
```bash
cat .github/workflows/release-please.yml
```
Check for: trigger on master, uses googleapis action v4, references both config files.
  </verify>
  <done>Workflow file exists with correct trigger (master), action version (v4), and config file references</done>
</task>

</tasks>

<verification>
1. All three files exist and are valid (JSON parses, YAML parses)
2. Config file uses Keep a Changelog section names (Added, Fixed, Changed)
3. Manifest version matches package.json version (0.12.3)
4. Workflow triggers on master (not main)
5. Workflow uses googleapis/release-please-action@v4 (not google-github-actions)
</verification>

<success_criteria>
- release-please-config.json exists with changelog-sections mapping
- .release-please-manifest.json exists with version "0.12.3"
- .github/workflows/release-please.yml exists and references both config files
- All files are valid JSON/YAML
- Workflow triggers on push to master branch
</success_criteria>

<output>
After completion, create `.planning/phases/06-cicd-automation/06-01-SUMMARY.md`
</output>
