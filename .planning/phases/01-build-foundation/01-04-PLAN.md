---
phase: 01-build-foundation
plan: 04
type: execute
wave: 3
depends_on: ["01-01", "01-02", "01-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Extension loads in Chrome without errors"
    - "Dev server starts with HMR capability"
    - "Pre-commit hook runs on git commit"
    - "Bundle analysis shows extension size breakdown"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete build infrastructure works end-to-end.

Purpose: Confirm all Phase 1 requirements are met before moving to code migration phases. This checkpoint validates BUILD-01 through BUILD-06 and QUAL-01 through QUAL-03.

Output: Verified build infrastructure ready for Phase 2 code migration.
</objective>

<execution_context>
@/home/jc/.claude/get-shit-done/workflows/execute-plan.md
@/home/jc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-build-foundation/01-01-SUMMARY.md
@.planning/phases/01-build-foundation/01-02-SUMMARY.md
@.planning/phases/01-build-foundation/01-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run comprehensive build verification</name>
  <files></files>
  <action>
Run all verification commands to confirm build infrastructure:

1. Clean build:
   ```bash
   rm -rf .output/
   npm run build
   ```

2. Verify build output structure:
   ```bash
   ls -la .output/chrome-mv3/
   cat .output/chrome-mv3/manifest.json
   ```

   Expected: manifest.json with correct name, permissions, icons, entrypoints

3. Verify TypeScript compilation:
   ```bash
   npx tsc --noEmit
   ```

   Expected: No errors (or only errors in legacy code being ignored)

4. Verify source maps:
   ```bash
   ls .output/chrome-mv3/*.js.map 2>/dev/null || find .output/chrome-mv3 -name "*.map"
   ```

   Expected: Source map files present

5. Verify dev server starts:
   ```bash
   timeout 10 npm run dev || true
   ```

   Expected: Server starts, shows HMR ready message

6. Verify lint runs:
   ```bash
   npm run lint
   ```

   Expected: Biome executes (may have warnings in legacy code)

7. Verify pre-commit hook:
   ```bash
   cat .husky/pre-commit
   ls -la .husky/pre-commit
   ```

   Expected: Hook exists and is executable

8. Verify bundle analysis:
   ```bash
   npm run analyze
   ls -la .output/stats.html
   ```

   Expected: stats.html generated

Report results of each verification step.
  </action>
  <verify>
All 8 verification steps complete with expected results
  </verify>
  <done>Build infrastructure verified: build, TypeScript, source maps, dev server, lint, pre-commit, bundle analysis all working</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Phase 1 build infrastructure:
- WXT project with dev server and HMR
- TypeScript strict mode compilation
- Biome linting and formatting
- Pre-commit hooks via Husky
- Bundle size analysis
- Static assets (icons, i18n) in public/
  </what-built>
  <how-to-verify>
1. Load extension in Chrome:
   - Open chrome://extensions
   - Enable "Developer mode" (toggle in top-right)
   - Click "Load unpacked"
   - Select the `.output/chrome-mv3/` directory
   - Extension should load without errors

2. Verify extension appears:
   - QuickTab icon should appear in Chrome toolbar
   - Click icon to open popup (should show placeholder content)

3. Verify dev server (optional):
   - Run `npm run dev` in terminal
   - Dev server should start with HMR
   - Changes to entrypoints should trigger reload

4. Verify pre-commit hook:
   - Make a small change to any .ts file
   - Run `git add . && git commit -m "test"`
   - Pre-commit hook should run lint-staged
   - (Cancel commit with Ctrl+C after hook runs if needed)

5. Verify bundle analysis:
   - Open `.output/stats.html` in browser
   - Should show treemap visualization of bundle

If all steps pass, type "approved" to complete Phase 1.
If issues found, describe the problems.
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
All Phase 1 requirements verified:

| Requirement | Verification |
|-------------|--------------|
| BUILD-01: WXT with Vite | npm run build succeeds |
| BUILD-02: TypeScript 5.9+ strict | npx tsc --noEmit passes |
| BUILD-03: Source maps | .map files in build output |
| BUILD-04: npm scripts | dev, build, lint, format all work |
| BUILD-05: HMR | npm run dev starts with HMR |
| BUILD-06: Bundle analysis | npm run analyze generates stats |
| QUAL-01: Biome | npm run lint executes |
| QUAL-02: Pre-commit hooks | .husky/pre-commit runs lint-staged |
| QUAL-03: @types/chrome | TypeScript recognizes Chrome APIs |
</verification>

<success_criteria>
- Human verified extension loads in Chrome
- Human verified popup opens without errors
- All automated verification steps passed
- Phase 1 ready for completion
</success_criteria>

<output>
After completion, create `.planning/phases/01-build-foundation/01-04-SUMMARY.md`
</output>
