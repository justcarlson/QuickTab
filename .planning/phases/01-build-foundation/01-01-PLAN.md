---
phase: 01-build-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - wxt.config.ts
  - tsconfig.json
  - entrypoints/background.ts
  - entrypoints/popup/index.html
  - entrypoints/popup/main.ts
  - entrypoints/popup/style.css
  - entrypoints/welcome/index.html
  - entrypoints/welcome/main.ts
autonomous: true

must_haves:
  truths:
    - "npm run dev starts WXT dev server without errors"
    - "npm run build produces output in .output/ directory"
    - "TypeScript compiles with strict mode and ES2022 target"
  artifacts:
    - path: "wxt.config.ts"
      provides: "WXT and manifest configuration"
      contains: "defineConfig"
    - path: "tsconfig.json"
      provides: "TypeScript configuration extending WXT"
      contains: "strict"
    - path: "entrypoints/background.ts"
      provides: "Service worker entrypoint scaffold"
      contains: "defineBackground"
    - path: "entrypoints/popup/index.html"
      provides: "Popup UI HTML shell"
      min_lines: 10
  key_links:
    - from: "tsconfig.json"
      to: ".wxt/tsconfig.json"
      via: "extends"
      pattern: '"extends".*".wxt/tsconfig.json"'
    - from: "wxt.config.ts"
      to: "manifest"
      via: "defineConfig"
      pattern: "manifest.*permissions"
---

<objective>
Initialize WXT project with TypeScript configuration and create minimal entrypoint scaffolds.

Purpose: Establish the modern build foundation that all subsequent phases depend on. This is the structural migration from Grunt/Webpack to WXT/Vite.

Output: Working WXT project structure with TypeScript strict mode, minimal entrypoints (background, popup, welcome), and functional dev/build commands.
</objective>

<execution_context>
@/home/jc/.claude/get-shit-done/workflows/execute-plan.md
@/home/jc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-build-foundation/01-CONTEXT.md
@.planning/phases/01-build-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize WXT project and configure package.json</name>
  <files>package.json, wxt.config.ts</files>
  <action>
1. Replace existing package.json with modern WXT-based configuration:
   - Keep name "QuickTab", version "0.11.8", description, author, license, repository info
   - Set "type": "module" for ESM
   - Add devDependencies: wxt@^0.20.13, typescript@^5.9.3, @types/chrome@latest
   - Add scripts: dev, build, zip, postinstall (wxt prepare)
   - Remove all grunt-* dependencies, webpack, and legacy tooling

2. Create wxt.config.ts with:
   - manifest.name: "Zendesk Quicktab"
   - manifest.description: "Well behaved browser tabs for Zendesk agents"
   - manifest.permissions: ['webNavigation', 'tabs', 'scripting', 'storage']
   - manifest.host_permissions: ['http://*.zendesk.com/*', 'https://*.zendesk.com/*']
   - vite config with sourcemap: true for development debugging
   - Do NOT add entrypointsDir - use WXT default (entrypoints/)

3. Run: npm install

4. Run: npm run postinstall (wxt prepare) to generate .wxt/ directory
  </action>
  <verify>
- `cat package.json | grep '"type": "module"'` returns match
- `cat package.json | grep wxt` shows wxt in devDependencies
- `ls -la wxt.config.ts` confirms file exists
- `ls -la .wxt/` confirms WXT generated directory exists
  </verify>
  <done>package.json modernized with WXT deps, wxt.config.ts created, .wxt/ generated</done>
</task>

<task type="auto">
  <name>Task 2: Configure TypeScript with strict mode</name>
  <files>tsconfig.json</files>
  <action>
Create tsconfig.json that extends WXT-generated config with strict settings:

```json
{
  "extends": ".wxt/tsconfig.json",
  "compilerOptions": {
    "strict": true,
    "target": "ES2022",
    "module": "ESNext",
    "moduleResolution": "bundler",
    "noUncheckedIndexedAccess": true,
    "noImplicitOverride": true,
    "skipLibCheck": true,
    "verbatimModuleSyntax": true
  }
}
```

Key settings:
- strict: true enables all strict type-checking options
- target: ES2022 for modern JavaScript features
- noUncheckedIndexedAccess: safer array/object access
- verbatimModuleSyntax: ESM import/export enforcement
  </action>
  <verify>
- `cat tsconfig.json | grep '"strict": true'` returns match
- `cat tsconfig.json | grep '"target": "ES2022"'` returns match
- `npx tsc --noEmit` runs without errors (may have no files to check yet)
  </verify>
  <done>TypeScript configured with strict mode and ES2022 target</done>
</task>

<task type="auto">
  <name>Task 3: Create minimal entrypoint scaffolds</name>
  <files>
    entrypoints/background.ts
    entrypoints/popup/index.html
    entrypoints/popup/main.ts
    entrypoints/popup/style.css
    entrypoints/welcome/index.html
    entrypoints/welcome/main.ts
  </files>
  <action>
Create WXT entrypoint scaffolds. These are MINIMAL placeholders - actual logic comes in Phase 2/3.

1. Create entrypoints/background.ts:
```typescript
export default defineBackground(() => {
  console.log('QuickTab background loaded', { id: browser.runtime.id });
});
```

2. Create entrypoints/popup/index.html:
```html
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QuickTab</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <div id="app">
      <h1>QuickTab</h1>
      <p>Popup placeholder - UI migration in Phase 3</p>
    </div>
    <script type="module" src="./main.ts"></script>
  </body>
</html>
```

3. Create entrypoints/popup/main.ts:
```typescript
console.log('QuickTab popup loaded');
```

4. Create entrypoints/popup/style.css:
```css
body {
  min-width: 300px;
  padding: 16px;
  font-family: system-ui, sans-serif;
}
```

5. Create entrypoints/welcome/index.html:
```html
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Welcome to QuickTab</title>
  </head>
  <body>
    <div id="app">
      <h1>Welcome to QuickTab</h1>
      <p>Welcome page placeholder - UI migration in Phase 3</p>
    </div>
    <script type="module" src="./main.ts"></script>
  </body>
</html>
```

6. Create entrypoints/welcome/main.ts:
```typescript
console.log('QuickTab welcome page loaded');
```
  </action>
  <verify>
- `ls -la entrypoints/` shows background.ts, popup/, welcome/
- `ls -la entrypoints/popup/` shows index.html, main.ts, style.css
- `npm run build` completes without TypeScript errors
- `ls -la .output/chrome-mv3/` shows generated extension files
  </verify>
  <done>Minimal entrypoint scaffolds created for background, popup, and welcome page</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Build verification:
   - `npm run build` produces .output/chrome-mv3/ with manifest.json
   - `cat .output/chrome-mv3/manifest.json` shows correct permissions and entrypoints

2. TypeScript verification:
   - `npx tsc --noEmit` runs without errors
   - Source maps present: `ls .output/chrome-mv3/*.map` or inline in files

3. Structure verification:
   - entrypoints/ directory with background.ts, popup/, welcome/
   - No legacy Grunt/Webpack files required for build
</verification>

<success_criteria>
- npm run dev starts WXT dev server (may show HMR ready message)
- npm run build produces loadable Chrome extension in .output/chrome-mv3/
- TypeScript compilation succeeds with strict mode
- Source maps generated for debugging
- All entrypoint scaffolds present and functional
</success_criteria>

<output>
After completion, create `.planning/phases/01-build-foundation/01-01-SUMMARY.md`
</output>
