---
phase: 01-build-foundation
plan: 03
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - wxt.config.ts
  - public/images/icons/icon-16.png
  - public/images/icons/icon-48.png
  - public/images/icons/icon-128.png
  - public/_locales/en/messages.json
autonomous: true

must_haves:
  truths:
    - "Extension icons load correctly in Chrome"
    - "i18n messages available to extension code"
    - "npm run build --analyze generates bundle stats"
  artifacts:
    - path: "public/images/icons/icon-128.png"
      provides: "Extension icon for Chrome toolbar"
    - path: "public/_locales/en/messages.json"
      provides: "Internationalization message strings"
      contains: "appName"
    - path: "wxt.config.ts"
      provides: "Bundle visualizer configuration"
      contains: "visualizer"
  key_links:
    - from: "wxt.config.ts"
      to: "rollup-plugin-visualizer"
      via: "Vite plugin"
      pattern: "visualizer"
---

<objective>
Move static assets (icons, i18n) to WXT public directory and add bundle analysis capability.

Purpose: Complete the build infrastructure by properly locating static assets in WXT conventions and adding bundle size monitoring per BUILD-06.

Output: Icons and i18n messages in public/ directory, bundle visualizer integrated into build.
</objective>

<execution_context>
@/home/jc/.claude/get-shit-done/workflows/execute-plan.md
@/home/jc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-build-foundation/01-CONTEXT.md
@.planning/phases/01-build-foundation/01-RESEARCH.md
@.planning/phases/01-build-foundation/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Move static assets to public directory</name>
  <files>
    public/images/icons/icon-16.png
    public/images/icons/icon-48.png
    public/images/icons/icon-128.png
    public/_locales/en/messages.json
  </files>
  <action>
1. Create public directory structure:
   ```bash
   mkdir -p public/images/icons
   mkdir -p public/_locales/en
   ```

2. Copy existing icons from legacy location to public/:
   - Check app/images/icons/ for existing icons (icon-16.png, icon-48.png, icon-128.png)
   - Copy to public/images/icons/

   ```bash
   cp app/images/icons/icon-*.png public/images/icons/
   ```

   If icons don't exist or are different sizes, note which sizes exist.

3. Copy existing i18n messages:
   - Check app/_locales/en/messages.json
   - Copy to public/_locales/en/messages.json

   ```bash
   cp app/_locales/en/messages.json public/_locales/en/
   ```

4. Update wxt.config.ts to reference icons in manifest:
   Add to manifest section:
   ```typescript
   icons: {
     16: 'images/icons/icon-16.png',
     48: 'images/icons/icon-48.png',
     128: 'images/icons/icon-128.png',
   },
   default_locale: 'en',
   ```

5. Verify icons are included in build:
   ```bash
   npm run build
   ls -la .output/chrome-mv3/images/icons/
   ```
  </action>
  <verify>
- `ls -la public/images/icons/` shows icon files
- `ls -la public/_locales/en/messages.json` shows messages file
- `npm run build && ls .output/chrome-mv3/images/icons/` shows icons in build output
- `cat .output/chrome-mv3/manifest.json | grep '"icons"'` shows icon references
  </verify>
  <done>Static assets (icons, i18n) moved to public/ and included in build</done>
</task>

<task type="auto">
  <name>Task 2: Add bundle visualizer for size analysis</name>
  <files>wxt.config.ts, package.json</files>
  <action>
1. Install rollup-plugin-visualizer:
   ```bash
   npm install -D rollup-plugin-visualizer@^6.0
   ```

2. Update wxt.config.ts to conditionally include visualizer:
   ```typescript
   import { defineConfig } from 'wxt';
   import { visualizer } from 'rollup-plugin-visualizer';

   export default defineConfig({
     manifest: {
       name: 'Zendesk Quicktab',
       description: 'Well behaved browser tabs for Zendesk agents',
       permissions: ['webNavigation', 'tabs', 'scripting', 'storage'],
       host_permissions: ['http://*.zendesk.com/*', 'https://*.zendesk.com/*'],
       icons: {
         16: 'images/icons/icon-16.png',
         48: 'images/icons/icon-48.png',
         128: 'images/icons/icon-128.png',
       },
       default_locale: 'en',
     },
     vite: (env) => ({
       plugins: env.command === 'build' && process.env.ANALYZE ? [
         visualizer({
           filename: '.output/stats.html',
           template: 'treemap',
           gzipSize: true,
           brotliSize: true,
         }),
       ] : [],
       build: {
         sourcemap: true,
       },
     }),
   });
   ```

3. Add analyze script to package.json:
   ```json
   {
     "scripts": {
       "analyze": "ANALYZE=true wxt build && echo 'Bundle stats: .output/stats.html'"
     }
   }
   ```

   Note: On Windows, use cross-env or set ANALYZE differently. For this project, Linux assumed.

4. Test bundle analysis:
   ```bash
   npm run analyze
   ```

   Should create .output/stats.html
  </action>
  <verify>
- `cat package.json | grep '"analyze"'` shows analyze script
- `npm run analyze` completes without errors
- `ls -la .output/stats.html` shows stats file generated
- Opening .output/stats.html in browser shows treemap visualization
  </verify>
  <done>Bundle visualizer integrated, npm run analyze generates stats.html</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Static assets verification:
   - `npm run build` includes icons in .output/chrome-mv3/images/icons/
   - manifest.json references icons correctly
   - i18n messages.json copied to build output

2. Bundle analysis verification:
   - `npm run analyze` produces .output/stats.html
   - Stats file is viewable in browser (treemap showing bundle composition)

3. Full build verification:
   - Load extension from .output/chrome-mv3/ in Chrome (chrome://extensions, developer mode, load unpacked)
   - Extension icon appears in toolbar
</verification>

<success_criteria>
- Icons copied from legacy app/ to public/images/icons/
- i18n messages copied to public/_locales/en/
- Build output includes static assets in correct locations
- manifest.json has icon paths and default_locale
- npm run analyze generates bundle visualization
- Bundle stats show treemap of extension size
</success_criteria>

<output>
After completion, create `.planning/phases/01-build-foundation/01-03-SUMMARY.md`
</output>
