---
phase: 05-webstore-compliance
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - PRIVACY.md
  - wxt.config.ts
autonomous: true

must_haves:
  truths:
    - "PRIVACY.md explains data handling in plain language"
    - "Privacy policy emphasizes no data leaves the device"
    - "Unused scripting permission removed from manifest"
    - "Production build excludes source maps from ZIP"
  artifacts:
    - path: "PRIVACY.md"
      provides: "Privacy policy for Chrome Web Store submission"
      contains: "We don't collect your data"
    - path: "wxt.config.ts"
      provides: "WXT configuration with corrected permissions and build settings"
      exports: ["defineConfig"]
  key_links:
    - from: "wxt.config.ts"
      to: "dist manifest"
      via: "manifest.permissions array"
      pattern: '"tabs".*"storage"'
---

<objective>
Create privacy policy document and clean up manifest configuration.

Purpose: Establish compliance foundation - privacy policy is required for Chrome Web Store submission, and removing unused permissions prevents review delays.
Output: PRIVACY.md document ready for linking, wxt.config.ts with correct permissions and build settings.
</objective>

<execution_context>
@/home/jc/.claude/get-shit-done/workflows/execute-plan.md
@/home/jc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-webstore-compliance/05-CONTEXT.md
@.planning/phases/05-webstore-compliance/05-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create PRIVACY.md</name>
  <files>PRIVACY.md</files>
  <action>
Create PRIVACY.md in repository root with plain-language privacy policy per CONTEXT.md decisions:

Structure:
1. **The Short Version** - "We don't collect your data. Period." Direct and confident.
2. **What QuickTab Accesses** - Watches for zendesk.com navigation locally, nothing leaves device
3. **What QuickTab Stores** - Detection mode preference in chrome.storage.local
4. **What QuickTab Does NOT Do** - No analytics, no tracking, no accounts, no external communication
5. **Permissions Explained** - Table format with user-friendly explanations:
   - webNavigation: Detect Zendesk navigation for routing
   - tabs: Find and focus existing Zendesk tabs
   - storage: Save detection mode preference
   - host_permissions (zendesk.com): Only operate on Zendesk domains
6. **Changes to This Policy** - Simple update notice
7. **Questions?** - Link to GitHub issues

Include effective/updated date headers. Use markdown formatting. Keep tone conversational, not legal jargon.
  </action>
  <verify>cat PRIVACY.md | head -50 && grep -c "collect" PRIVACY.md</verify>
  <done>PRIVACY.md exists with all 7 sections, mentions no data collection, includes permissions table</done>
</task>

<task type="auto">
  <name>Task 2: Update wxt.config.ts for compliance</name>
  <files>wxt.config.ts</files>
  <action>
Modify wxt.config.ts with three changes:

1. **Remove unused scripting permission:**
   - Change permissions array from ["webNavigation", "tabs", "scripting", "storage"]
   - To: ["webNavigation", "tabs", "storage"]
   - Reason: chrome.scripting is never called in modernized codebase (verified via grep)

2. **Configure sourcemap for production:**
   - Change `sourcemap: true` to conditional:
   - `sourcemap: env.mode === "production" ? "hidden" : true`
   - "hidden" generates maps but excludes them from the bundle

3. **Configure ZIP artifact naming:**
   - Add zip configuration block:
   ```typescript
   zip: {
     artifactTemplate: "quicktab-v{{version}}-{{browser}}.zip",
   },
   ```

Keep existing visualizer plugin configuration unchanged.
  </action>
  <verify>npm run build && ls -la .output/chrome-mv3/ | grep -v ".map" | head -10</verify>
  <done>
    - Permissions array has exactly 3 items (webNavigation, tabs, storage)
    - Production build does not include .map files in output
    - wxt.config.ts includes zip.artifactTemplate
  </done>
</task>

</tasks>

<verification>
1. `cat PRIVACY.md` - Privacy policy exists with required sections
2. `grep -r "scripting" wxt.config.ts` - No scripting permission declared
3. `npm run build && ls .output/chrome-mv3/*.map 2>/dev/null | wc -l` - Returns 0 (no map files)
4. `grep "artifactTemplate" wxt.config.ts` - Template configured
</verification>

<success_criteria>
- PRIVACY.md exists at repository root with plain-language privacy policy
- wxt.config.ts permissions array contains only webNavigation, tabs, storage
- Production build completes without source maps in output
- ZIP naming template configured for versioned artifacts
</success_criteria>

<output>
After completion, create `.planning/phases/05-webstore-compliance/05-01-SUMMARY.md`
</output>
