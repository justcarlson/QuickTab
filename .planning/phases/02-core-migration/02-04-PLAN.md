---
phase: 02-core-migration
plan: 04
type: execute
wave: 3
depends_on: ["02-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Extension loads in Chrome without errors"
    - "Zendesk navigation intercepts and routes to existing tab"
    - "State persists across service worker restart"
    - "Detection mode setting works (allUrls, ticketUrls, noUrls)"
  artifacts: []
  key_links: []
---

<objective>
Verify core migration by loading extension in Chrome and testing navigation behavior

Purpose: This is a human verification checkpoint to confirm the migrated service worker correctly intercepts Zendesk navigation and routes it to existing agent tabs. The core value proposition must be validated before proceeding to UI migration.

Output: Human confirmation that the extension works, or list of issues to fix
</objective>

<execution_context>
@/home/jc/.claude/get-shit-done/workflows/execute-plan.md
@/home/jc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-core-migration/02-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build extension and verify no errors</name>
  <files></files>
  <action>
Run production build and verify:

1. npm run build
2. Check no TypeScript errors in output
3. Check no Biome errors in output
4. Verify .output/chrome-mv3/ contains:
   - manifest.json
   - background.js
   - images/icons/*
5. Check background.js is not empty and contains expected exports
  </action>
  <verify>
npm run build && ls -la .output/chrome-mv3/ && head -50 .output/chrome-mv3/background.js
  </verify>
  <done>
Build succeeds without errors, all expected files present
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Service worker with Zendesk navigation interception and tab routing. The extension should:
- Intercept navigation to zendesk.com/agent/* URLs
- Route the navigation to an existing Zendesk agent tab (if one exists)
- Close the source tab after routing
- Show enabled/disabled icon based on detection mode
  </what-built>
  <how-to-verify>
1. Build extension: `npm run build`

2. Load extension in Chrome:
   - Open chrome://extensions
   - Enable Developer Mode
   - Click "Load unpacked"
   - Select `.output/chrome-mv3/`

3. Open DevTools for service worker:
   - On chrome://extensions, find QuickTab
   - Click "service worker" link to open DevTools
   - Watch console for "QuickTab service worker started"

4. Test navigation interception:
   a. Open any Zendesk agent page (e.g., yourcompany.zendesk.com/agent/)
   b. Open a NEW tab and navigate to a ticket URL on same subdomain
      (e.g., yourcompany.zendesk.com/agent/tickets/123)
   c. Expected: New tab closes, original tab navigates to ticket URL

5. Test service worker persistence:
   a. In DevTools, click "Skip waiting" or reload extension
   b. Repeat test from step 4
   c. Expected: Behavior still works (state loaded from storage)

6. Check for console errors:
   - Should see lifecycle logs, no errors
   - Storage operations should succeed

Note: If you don't have a Zendesk account, you can verify the extension loads without errors and the service worker starts successfully.
  </how-to-verify>
  <resume-signal>
Type "approved" if core navigation behavior works, or describe issues encountered
  </resume-signal>
</task>

</tasks>

<verification>
1. Build succeeds without errors
2. Extension loads in Chrome
3. Service worker starts and logs to console
4. Navigation interception works (if testable)
5. No runtime errors in console
</verification>

<success_criteria>
- Human confirms extension loads without errors
- Human confirms service worker starts (console log visible)
- Human confirms navigation interception works (or confirms untestable without Zendesk)
- No blocking issues identified
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-migration/02-04-SUMMARY.md`
</output>
