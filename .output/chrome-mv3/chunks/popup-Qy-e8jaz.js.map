{"version":3,"file":"popup-Qy-e8jaz.js","sources":["../../../entrypoints/popup/main.ts"],"sourcesContent":["/**\n * QuickTab Popup\n *\n * Displays current detection mode and allows toggling between modes.\n * Communicates with background service worker via chrome.runtime.sendMessage.\n */\n\nimport type { UrlDetectionMode } from \"@/src/utils/types\";\n\ninterface GetStatusResponse {\n\tmode: UrlDetectionMode;\n}\n\n/**\n * Get localized string with fallback to key name.\n */\nfunction t(key: string): string {\n\treturn chrome.i18n.getMessage(key) || `[${key}]`;\n}\n\n/**\n * Request current mode from background service worker.\n */\nasync function getStatus(): Promise<UrlDetectionMode> {\n\tconst response = await chrome.runtime.sendMessage({ type: \"getStatus\" });\n\treturn (response as GetStatusResponse).mode;\n}\n\n/**\n * Send mode change to background service worker.\n */\nasync function setMode(mode: UrlDetectionMode): Promise<void> {\n\tawait chrome.runtime.sendMessage({ type: \"setMode\", mode });\n}\n\n/**\n * Update radio button selection to match current mode.\n */\nfunction updateModeUI(currentMode: UrlDetectionMode): void {\n\tconst radios = document.querySelectorAll<HTMLInputElement>('input[name=\"detection-mode\"]');\n\tradios.forEach((radio) => {\n\t\tradio.checked = radio.value === currentMode;\n\t});\n}\n\n/**\n * Populate all i18n strings in the popup.\n */\nfunction populateI18n(): void {\n\t// Section headings\n\tconst modeHeading = document.getElementById(\"mode-heading\");\n\tif (modeHeading) {\n\t\tmodeHeading.textContent = t(\"txt_popup_title_link_detection\");\n\t}\n\n\tconst helpHeading = document.getElementById(\"help-heading\");\n\tif (helpHeading) {\n\t\thelpHeading.textContent = t(\"txt_popup_title_help\");\n\t}\n\n\t// Mode labels\n\tconst labelAllUrls = document.getElementById(\"label-allUrls\");\n\tif (labelAllUrls) {\n\t\tlabelAllUrls.textContent = t(\"txt_popup_options_link_detection_allLinks\");\n\t}\n\n\tconst labelTicketUrls = document.getElementById(\"label-ticketUrls\");\n\tif (labelTicketUrls) {\n\t\tlabelTicketUrls.textContent = t(\"txt_popup_options_link_detection_ticketLinks\");\n\t}\n\n\tconst labelNoUrls = document.getElementById(\"label-noUrls\");\n\tif (labelNoUrls) {\n\t\tlabelNoUrls.textContent = t(\"txt_popup_options_link_detection_noLinks\");\n\t}\n\n\t// Help links\n\tconst linkDocs = document.getElementById(\"link-docs\");\n\tif (linkDocs) {\n\t\tlinkDocs.textContent = t(\"txt_popup_options_help_documentation\");\n\t}\n\n\tconst linkWelcome = document.getElementById(\"link-welcome\");\n\tif (linkWelcome) {\n\t\tlinkWelcome.textContent = t(\"txt_popup_options_help_welcome\");\n\t}\n}\n\n/**\n * Initialize popup on DOM ready.\n */\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\n\t// Populate i18n strings first (while loading)\n\tpopulateI18n();\n\n\ttry {\n\t\t// Load current mode from background\n\t\tconst currentMode = await getStatus();\n\t\tupdateModeUI(currentMode);\n\t} catch (error) {\n\t\t// Silent fallback - default to allUrls on error\n\t\tconsole.warn(\"QuickTab: Failed to get status\", error);\n\t\tupdateModeUI(\"allUrls\");\n\t}\n\n\t// Remove loading state\n\tconst app = document.getElementById(\"app\");\n\tif (app) {\n\t\tapp.classList.remove(\"loading\");\n\t}\n\n\t// Bind mode change handlers\n\tdocument.querySelectorAll<HTMLInputElement>('input[name=\"detection-mode\"]').forEach((radio) => {\n\t\tradio.addEventListener(\"change\", async () => {\n\t\t\tif (radio.checked) {\n\t\t\t\ttry {\n\t\t\t\t\tawait setMode(radio.value as UrlDetectionMode);\n\t\t\t\t} catch (error) {\n\t\t\t\t\t// Silent fallback - log but don't show error to user\n\t\t\t\t\tconsole.warn(\"QuickTab: Failed to set mode\", error);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\n\t// Bind welcome page link\n\tconst linkWelcome = document.getElementById(\"link-welcome\");\n\tif (linkWelcome) {\n\t\tlinkWelcome.addEventListener(\"click\", (e) => {\n\t\t\te.preventDefault();\n\t\t\tconst welcomeUrl = chrome.runtime.getURL(\"welcome.html\");\n\t\t\tchrome.tabs.create({ url: welcomeUrl });\n\t\t});\n\t}\n});\n"],"names":["t","key","getStatus","setMode","mode","updateModeUI","currentMode","radio","populateI18n","modeHeading","helpHeading","labelAllUrls","labelTicketUrls","labelNoUrls","linkDocs","linkWelcome","error","app","welcomeUrl"],"mappings":"gDAgBA,SAASA,EAAEC,EAAqB,CAC/B,OAAO,OAAO,KAAK,WAAWA,CAAG,GAAK,IAAIA,CAAG,GAC9C,CAKA,eAAeC,GAAuC,CAErD,OADiB,MAAM,OAAO,QAAQ,YAAY,CAAE,KAAM,YAAa,GAChC,IACxC,CAKA,eAAeC,EAAQC,EAAuC,CAC7D,MAAM,OAAO,QAAQ,YAAY,CAAE,KAAM,UAAW,KAAAA,EAAM,CAC3D,CAKA,SAASC,EAAaC,EAAqC,CAC3C,SAAS,iBAAmC,8BAA8B,EAClF,QAASC,GAAU,CACzBA,EAAM,QAAUA,EAAM,QAAUD,CACjC,CAAC,CACF,CAKA,SAASE,GAAqB,CAE7B,MAAMC,EAAc,SAAS,eAAe,cAAc,EACtDA,IACHA,EAAY,YAAcT,EAAE,gCAAgC,GAG7D,MAAMU,EAAc,SAAS,eAAe,cAAc,EACtDA,IACHA,EAAY,YAAcV,EAAE,sBAAsB,GAInD,MAAMW,EAAe,SAAS,eAAe,eAAe,EACxDA,IACHA,EAAa,YAAcX,EAAE,2CAA2C,GAGzE,MAAMY,EAAkB,SAAS,eAAe,kBAAkB,EAC9DA,IACHA,EAAgB,YAAcZ,EAAE,8CAA8C,GAG/E,MAAMa,EAAc,SAAS,eAAe,cAAc,EACtDA,IACHA,EAAY,YAAcb,EAAE,0CAA0C,GAIvE,MAAMc,EAAW,SAAS,eAAe,WAAW,EAChDA,IACHA,EAAS,YAAcd,EAAE,sCAAsC,GAGhE,MAAMe,EAAc,SAAS,eAAe,cAAc,EACtDA,IACHA,EAAY,YAAcf,EAAE,gCAAgC,EAE9D,CAKA,SAAS,iBAAiB,mBAAoB,SAAY,CAEzDQ,EAAA,EAEA,GAAI,CAEH,MAAMF,EAAc,MAAMJ,EAAA,EAC1BG,EAAaC,CAAW,CACzB,OAASU,EAAO,CAEf,QAAQ,KAAK,iCAAkCA,CAAK,EACpDX,EAAa,SAAS,CACvB,CAGA,MAAMY,EAAM,SAAS,eAAe,KAAK,EACrCA,GACHA,EAAI,UAAU,OAAO,SAAS,EAI/B,SAAS,iBAAmC,8BAA8B,EAAE,QAASV,GAAU,CAC9FA,EAAM,iBAAiB,SAAU,SAAY,CAC5C,GAAIA,EAAM,QACT,GAAI,CACH,MAAMJ,EAAQI,EAAM,KAAyB,CAC9C,OAASS,EAAO,CAEf,QAAQ,KAAK,+BAAgCA,CAAK,CACnD,CAEF,CAAC,CACF,CAAC,EAGD,MAAMD,EAAc,SAAS,eAAe,cAAc,EACtDA,GACHA,EAAY,iBAAiB,QAAU,GAAM,CAC5C,EAAE,eAAA,EACF,MAAMG,EAAa,OAAO,QAAQ,OAAO,cAAc,EACvD,OAAO,KAAK,OAAO,CAAE,IAAKA,EAAY,CACvC,CAAC,CAEH,CAAC"}